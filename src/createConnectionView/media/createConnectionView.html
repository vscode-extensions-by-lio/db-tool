<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="{{styleUri}}" rel="stylesheet" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'self' https://file%2B.vscode-resource.vscode-cdn.net; script-src 'self' 'nonce-{{nonce}}';">
</head>
<body>
  <h2>Create Connection</h2>
  <label>Connection Name:</label><br/>
  <input id="name" value="My Connection"/><br/><br/>

  <label>DataBase:</label><br/>
  <input id="database" value="postgres"/><br/><br/>

  <label>Host:</label><br/>
  <input id="host" value="localhost"/><br/><br/>

  <label>Port:</label><br/>
  <input id="port" value="5432"/><br/><br/>

  <label>User:</label><br/>
  <input id="user" value="postgres"/><br/><br/>

  <label>Password:</label><br/>
  <input id="password" type="password" value="postgres"/><br/><br/>

  <label>
    <input type="checkbox" id="remember" checked/>
    Remember password
  </label><br/><br/>

  <button onclick="conn()" id="conn">test Connection</button>

  <button onclick="save()" id="save">Save</button>

  <script nonce="{{nonce}}">

    const vscode = acquireVsCodeApi();

    async function save() {
      vscode.postMessage({
        command: "saveConnection",
        name: document.getElementById("name").value,
        database: document.getElementById("database").value,
        host: document.getElementById("host").value,
        port: document.getElementById("port").value,
        user: document.getElementById("user").value,
        password: document.getElementById("password").value,
        remember: document.getElementById("remember").checked
      });
    }

    async function conn() {
      vscode.postMessage({
        command: "testConnection",
        name: document.getElementById("name").value,
        database: document.getElementById("database").value,
        host: document.getElementById("host").value,
        port: document.getElementById("port").value,
        user: document.getElementById("user").value,
        password: document.getElementById("password").value
      });
    }

    // 给按钮绑定事件
    document.getElementById("conn").addEventListener('click', conn);
    document.getElementById("save").addEventListener('click', save);

  </script>
</body>
</html>